---
- block:

    - name: Set random prefix
      set_fact:
        prefix: "{{ 99999999 | random | to_uuid | hash('md5') }}"

    - name: Create network - check mode
      network:
        name: "{{ ( prefix + '_network' ) }}"
      check_mode: true
      register: check_network

    - name: assert result
      assert:
        that:
          - check_network is changed

    - name: Create network
      network:
        name: "{{ ( prefix + '_network' ) }}"
      register: created_network

    - name: assert result
      assert:
        that:
          - created_network is success
          - created_network is changed

    - name: Remove network
      network:
        name: "{{ created_network.network.name }}"
      register: removed_network

    - name: assert result
      assert:
        that:
          - removed_network is success
          - removed_network is changed
